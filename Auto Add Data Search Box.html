<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body {
      font-family:'Segoe UI',sans-serif; background:#f0f0f0; padding:20px;
      transition:background 0.3s, color 0.3s;
    }
    .dark-mode { background: #121212; color: white; }
    .container {
      max-width:500px; margin:auto; background:white;
      padding:20px; border-radius:10px;
    }
    .dark-mode .container { background: #1e1e1e; }
    h2,h3 { text-align:center; }
    .form-group { display:flex; flex-direction:column; gap:10px; margin-bottom:20px; }
    input,button {
      padding:10px; font-size:16px;
      border:1px solid #ccc; border-radius:6px;
    }
    .dark-mode input, .dark-mode button {
      background:#333; color:white; border:1px solid #555;
    }
    button { background:#27ae60; color:white; font-weight:bold; border:none; }
    button:hover { background:#1e8449; }
    table { width:100%; border-collapse:collapse; margin-top:10px; }
    th,td {
      padding:8px; border:1px solid #ddd; font-size:14px; text-align:left;
    }
    th { background-color:#2ecc71; color:white; }
    .dark-mode th { background-color:#27ae60; }
    .action-btn {
      font-size:12px; padding:5px 10px; border:none;
      border-radius:4px; margin:2px; color:white;
    }
    .edit-btn { background-color:#f1c40f; }
    .delete-btn { background-color:#e74c3c; }
    .export-btn {
      background-color:#2980b9; margin-top:15px; width:100%;
    }
    .search-bar {
      display:flex; gap:10px; margin-bottom:10px;
    }
    .toggle-mode {
      float: right; margin-top: -40px;
      background: #555; padding: 5px 10px;
      border-radius: 4px; font-size: 14px; color: white;
      border: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <button class="toggle-mode" onclick="toggleDarkMode()">üåô Dark</button>
    <h2>Data Entry (Local)</h2>

    <div class="form-group">
      <input type="text" id="name" placeholder="Enter Name">
      <input type="text" id="mobile" placeholder="Enter Mobile">
      <input type="text" id="address" placeholder="Enter Address">
      <button onclick="submitData()">Submit</button>
    </div>

    <div class="search-bar">
      <input type="text" id="searchMobile" placeholder="Search by Mobile">
      <button onclick="searchRecord()">Search</button>
      <button onclick="clearSearch()">Clear</button>
    </div>

    <h3>Records</h3>
    <table id="dataTable">
      <thead>
        <tr><th>Name</th><th>Mobile</th><th>Address</th><th>Action</th></tr>
      </thead>
      <tbody></tbody>
    </table>

    <button class="export-btn" onclick="exportToCSV()">‚¨áÔ∏è Export to CSV</button>
  </div>

  <script>
    let records = [];

    function loadRecords() {
      const json = localStorage.getItem('records');
      records = json ? JSON.parse(json) : [];
    }

    function saveRecords() {
      localStorage.setItem('records', JSON.stringify(records));
    }

    function submitData() {
      const n = document.getElementById('name').value.trim();
      const m = document.getElementById('mobile').value.trim();
      const a = document.getElementById('address').value.trim();

      if (!n || !m || !a) {
        alert('Fill all fields');
        return;
      }

      // Check duplicate mobile
      const existing = records.find(r => r.mobile === m);
      if (existing) {
        alert('Mobile already exists!');
        return;
      }

      records.push({ name: n, mobile: m, address: a });
      saveRecords();
      renderTable();
      document.getElementById('name').value = '';
      document.getElementById('mobile').value = '';
      document.getElementById('address').value = '';
    }

    function renderTable(filtered = null) {
      const tbody = document.querySelector('#dataTable tbody');
      tbody.innerHTML = '';
      (filtered || records).forEach(r => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${r.name}</td><td>${r.mobile}</td><td>${r.address}</td>
          <td>
            <button class="action-btn edit-btn" onclick="editRow('${r.name}','${r.mobile}','${r.address}')">Edit</button>
            <button class="action-btn delete-btn" onclick="deleteRow('${r.mobile}')">Delete</button>
          </td>`;
        tbody.appendChild(tr);
      });
    }

    function editRow(name, mobile, address) {
      document.getElementById('name').value = name;
      document.getElementById('mobile').value = mobile;
      document.getElementById('address').value = address;
      records = records.filter(r => r.mobile !== mobile);
      saveRecords();
      renderTable();
    }

    function deleteRow(mobile) {
      if (confirm('Are you sure to delete this record?')) {
        records = records.filter(r => r.mobile !== mobile);
        saveRecords();
        renderTable();
      }
    }

    function searchRecord() {
      const sm = document.getElementById('searchMobile').value.trim();
      const filtered = records.filter(r => r.mobile.includes(sm));
      renderTable(filtered);
    }

    function clearSearch() {
      document.getElementById('searchMobile').value = '';
      renderTable();
    }

    function exportToCSV() {
      if (!records.length) {
        alert('No data');
        return;
      }
      const header = ['Name', 'Mobile', 'Address'].join(',') + '\n';
      const body = records.map(r => `${r.name},${r.mobile},${r.address}`).join('\n');
      const blob = new Blob([header + body], { type: 'text/csv' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'data.csv';
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    function toggleDarkMode() {
      document.body.classList.toggle('dark-mode');
    }

    window.onload = () => {
      loadRecords();
      renderTable();
    };
  </script>
</body>
</html>